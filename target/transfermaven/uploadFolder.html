<!DOCTYPE html>
<html>
<head>
<title>uploadFolder.html</title>

<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
<meta http-equiv="description" content="this is my page">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link type="text/css" rel="stylesheet" href="css/progressBar.css" />
<style type="text/css">
	input[type="submit"]{
		background-color:#AAAAAA;
		color:white;
	}
</style>
<link type="text/css" rel="stylesheet" href="css/inputFile.css" />
     
<script type="text/javascript" src="js/jquery-1.4.3.js"></script>
<script type="text/javascript" language="Javascript">
var current_guid = "5a6b27c0-ad60-ca2f-e9e4-0f973d3b75a4";
    var interval;
	function progressBar(){
	  interval = setInterval(showProgress, 500);	
	}
		function showProgress(){
		 
			getNumb();
			
		}
		
		function getNumb(){
			$.ajax({
				url : '/transfer/rest/remotefile/get/'+current_guid,
				type : 'get',
				data : {},
				dataType : 'JSON',
				success : function(result) {
					var dataObj = eval("(" + result + ")");
					//alert(dataObj.received);
					var arrayObj = new Array(2);
					arrayObj = [dataObj.received,dataObj.totalFiles];
				    if(arrayObj ==null){
					   return;
					}
					//alert(arrayObj[0] +"  "+arrayObj[1]);
					var received = parseInt(arrayObj[0]);
					var totalFiles = parseInt(arrayObj[1]);
					var dataProgress = received/totalFiles;
					var stringProgress = toPercent(dataProgress);
						
					$('.pb-text').html(stringProgress);
					$('.pb-value').css("width",stringProgress);
					
					if(received>= totalFiles){
					  clearInterval(interval);
					}
					
																
				}
		
			});
		}
		function toPercent(data){
		    var strData = parseFloat(data)*10000;
		    strData = Math.round(strData);
		    strData/=100;
		    strData = strData.toFixed(0);
		    var ret = strData.toString()+"%";
		    return ret;
		}


		//Jquery生成Guid方法：
		function s4()
		{ 
		   return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
		};
		function guid() 
		{ 
		  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
		}
		
		
		function get_action(form) {
		   current_guid = guid();
           form.action = "/transfer/rest/remotefile/multipleFiles/"+current_guid;
           progressBar();
        }
</script>
</head>

<body>
	<h1>uploadFolder</h1>
	<br>
	
	<form  method="post" enctype="multipart/form-data" onsubmit="get_action(this)">
		<a href="javascript:;" class="file">
			选择多文件: <input type="file" name="fileMulti" multiple="multiple" />
		</a>
		<input type="submit" value="提交" onclick="progressBar()"/>
	</form>
	<br></br>
	<form  method="post" enctype="multipart/form-data" onsubmit="get_action(this)" >
		<a href="javascript:;" class="file">
			选择文件夹: 
				<input type="file" name="fileFolder"  webkitdirectory directory multiple />
		</a>
		<input type="submit" value="提交" onclick="progressBar()"/>
	</form>

		 <div class="process-bar skin-green">
     <div class="pb-wrapper">
     <div class="pb-highlight"></div>
     <div class="pb-container">
     <div class="pb-text">0%</div>
     <div class="pb-value" style="width:0%"></div>
     </div>
     </div>
</div>
</body>
</html>

